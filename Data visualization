from datetime import datetime
import pymysql
import pymysql.cursors
import csv

def select_all(table):
    connection = pymysql.connect(host="us-cdbr-east-05.cleardb.net",
                             user="b809ff374c792c",
                             password="bbc8de98",
                             database="heroku_9a97caadd884ab8",
                             charset='utf8mb4',
                             cursorclass=pymysql.cursors.DictCursor)
    with connection.cursor() as cursor:
        sql = f"select * from {table}"
        cursor.execute(sql)


        # 獲取多筆資料
    result_list = cursor.fetchall()  # 得到list
    for row in result_list:
        row = dict(row)
        # print(row)
        with open('table.csv', 'a', newline='') as f_object:
            writer_object = writer(f_object)
            writer_object.writerow(row.values())
    f_object.close()
        # 斷線
    cursor.close()
    connection.close()




select_all("table_name")
